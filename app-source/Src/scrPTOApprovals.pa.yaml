# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  scrPTOApprovals:
    Properties:
      Fill: |
        =RGBA(255, 255, 255, 1)
      Height: |
        =Max(App.Height, App.MinScreenHeight)
      LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
      OnVisible: |-
        =
        //Set(Size,scrAllDeliverables.Size);

        // Workstream dropdown
        ClearCollect(
            colWorkstreamDD,
            { Value: "All" }
        );
        Collect(
            colWorkstreamDD,
            Choices([@Deliverables].Workstream)
        );

        // Status dropdown
        ClearCollect(
            colStatusDD,
            { Value: "All" }
        );
        Collect(
            colStatusDD,
            Choices([@Deliverables].Status)
        );

        UpdateContext(
           {
               locShowDecisionDialog: false,
               locDecision: "",
               locPTORecord: Blank()
           }
        );

        // Current staff row
        Set(
           varCurrentStaff,
           LookUp(Staff, Email = User().Email)
        );
        // Is Admin?
        Set(
           varIsAdmin,
           !IsBlank(varCurrentStaff) && varCurrentStaff.Role.Value = "Admin"
        );
        // Workstreams where this person is a leader
        // (Leader is a People column with multiple selection = YES)
        Set(
           varLeaderWorkstreams,
           Filter(
               Workstreams,
               Active,
               User().Email in Leader.Email
           )
        );
        // Is Workstream Leader (of at least one WS)?
        Set(
           varIsLeader,
           CountRows(varLeaderWorkstreams) > 0
        );
        // Can this user approve PTO?
        Set(
           varCanApprovePTO,
           varIsAdmin || varIsLeader
        );
    Children:
      - Container11_17:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            DropShadow: =DropShadow.None
            Fill: =RGBA(255, 245, 237, 1)//ColorFade(Color.AliceBlue,0.5)
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Horizontal
            LayoutGap: =50
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width
          Children:
            - SidebarContainer1_19:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  Fill: =RGBA(255, 255, 255, 1)
                  FillPortions: =0
                  Height: =Parent.Height
                  LayoutDirection: =LayoutDirection.Vertical
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  Width: |-
                    =If(
                        scrPTOApprovals.Size = 1,
                        43,
                        If(
                            scrPTOApprovals.Size = 2,
                            43,
                            If(
                                scrPTOApprovals.Size = 3,
                                165,
                                260
                            )
                        )
                    )
                  X: =2
                Children:
                  - ContainerFirstButton_18:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =80
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        LayoutMinWidth: =0
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                      Children:
                        - TitleButton_16:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              FillPortions: =0
                              Height: =50
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutJustifyContent: =LayoutJustifyContent.Center
                              LayoutMinWidth: =0
                              PaddingLeft: =4
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Parent.Width
                            Children:
                              - Image1_65:
                                  Control: Image@2.2.3
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledFill: =RGBA(0, 0, 0, 0)
                                    FocusedBorderThickness: =4
                                    Height: =32
                                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                                    HoverFill: =RGBA(0, 0, 0, 0)
                                    Image: =TD_logo
                                    OnSelect: =Set(Size,scrAllDeliverables.Size)
                                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                                    PressedFill: =RGBA(0, 0, 0, 0)
                                    Width: =40
                              - TextCanvas1_16:
                                  Control: Text@0.0.51
                                  Properties:
                                    Align: ='TextCanvas.Align'.Center
                                    AlignInContainer: =AlignInContainer.Center
                                    FillPortions: =1
                                    Font: =Font.'Segoe UI'
                                    FontColor: =RGBA(254, 124, 57, 1)
                                    Height: =Parent.Height
                                    PaddingLeft: =5
                                    Size: =15
                                    Text: ="TD Bank Project Governance"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Visible: |-
                                      =If(
                                          scrAllDeliverables.Size = 1 || scrAllDeliverables.Size = 2 ||scrAllDeliverables.Size = 3,
                                          false,
                                          true
                                      )
                                    Weight: ='TextCanvas.Weight'.Bold
                  - NavigationContainer_20:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =Parent.Height-140
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =
                        X: =40
                        Y: =40
                      Children:
                        - ContainerComponent_2:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              Height: =Parent.Height
                              LayoutDirection: =LayoutDirection.Vertical
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Parent.Width
                            Children:
                              - NavGallery_2:
                                  Control: Gallery@2.15.0
                                  Variant: VariableHeight
                                  Properties:
                                    BorderColor: =RGBA(245, 245, 245, 1)
                                    Items: =NavCollection
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    LoadingSpinner: =LoadingSpinner.None
                                  Children:
                                    - ContainerMain_2:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          Height: =ContainerHeight_2.Y
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutJustifyContent: =LayoutJustifyContent.Center
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                          Width: =Parent.TemplateWidth
                                        Children:
                                          - ContainerButton_2:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                DropShadow: =DropShadow.None
                                                Fill: |-
                                                  =If(
                                                      VarCurrentScreen = ThisItem.ItemScreen,
                                                      RGBA(254, 124, 57, 1),
                                                      RGBA(0,0,0,0)
                                                  )
                                                FillPortions: =0
                                                Height: =40
                                                LayoutAlignItems: =LayoutAlignItems.Center
                                                LayoutDirection: =LayoutDirection.Horizontal
                                                LayoutMinWidth: =0
                                                RadiusBottomLeft: =8
                                                RadiusBottomRight: =8
                                                RadiusTopLeft: =8
                                                RadiusTopRight: =8
                                              Children:
                                                - ButtonNav_2:
                                                    Control: Button@0.0.45
                                                    Properties:
                                                      Align: =Align.Left
                                                      Appearance: ='ButtonCanvas.Appearance'.Secondary
                                                      BasePaletteColor: |-
                                                        = RGBA(
                                                                65,
                                                                105,
                                                                225,
                                                                1
                                                            )
                                                      BorderRadius: =0
                                                      FillPortions: =1
                                                      Font: =Font.'Segoe UI'
                                                      FontColor: |-
                                                        =If(
                                                            VarCurrentScreen = ThisItem.ItemScreen,
                                                            RGBA(255,255,255,1),
                                                            RGBA(0,0,0,1)
                                                        )
                                                      FontWeight: =FontWeight.Lighter
                                                      Icon: =ThisItem.ItemIconName
                                                      IconStyle: ='ButtonCanvas.IconStyle'.Outline
                                                      Layout: |-
                                                        =If(
                                                           scrPTOApprovals.Size = 1 || scrPTOApprovals.Size = 2 || scrPTOApprovals.Size = 3,
                                                            'ButtonCanvas.Layout'.IconOnly,
                                                            'ButtonCanvas.Layout'.IconBefore
                                                        )
                                                      LayoutMinWidth: =0
                                                      OnSelect: |-
                                                        =Set(VarCurrentScreen, ThisItem.ItemScreen);
                                                        Navigate(ThisItem.ItemScreen);
                                                      PaddingLeft: =6
                                                      Text: =ThisItem.ItemDisplayName
                                                - ButtonArrow_2:
                                                    Control: Button@0.0.45
                                                    Properties:
                                                      Align: =Align.Center
                                                      Appearance: ='ButtonCanvas.Appearance'.Subtle
                                                      BasePaletteColor: |-
                                                        = RGBA(
                                                                65,
                                                                105,
                                                                225,
                                                                1
                                                            )
                                                      BorderRadius: =0
                                                      FontColor: |-
                                                        =If(
                                                            VarCurrentScreen = ThisItem.ItemScreen,
                                                            RGBA(255,255,255,1),
                                                            RGBA(0,0,0,1)
                                                        )
                                                      FontWeight: =FontWeight.Normal
                                                      Icon: ="ChevronRight"
                                                      IconStyle: ='ButtonCanvas.IconStyle'.Outline
                                                      Layout: ='ButtonCanvas.Layout'.IconOnly
                                                      LayoutMinWidth: =0
                                                      OnSelect: |-
                                                        =Set(VarCurrentScreen, ThisItem.ItemScreen);
                                                        Navigate(ThisItem.ItemScreen);
                                                      Text: =ThisItem.ItemDisplayName
                                                      Visible: |-
                                                        =If(
                                                            scrPTOApprovals.Size = 1 || scrPTOApprovals.Size = 2 || scrPTOApprovals.Size = 3,
                                                            false,
                                                            true
                                                        )
                                                      Width: =32
                                          - ContainerHeight_2:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                DropShadow: =DropShadow.None
                                                FillPortions: =0
                                                Height: =1
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutMinWidth: =0
                  - ContainerLastButton_19:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =35
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        LayoutMinWidth: =0
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                      Children:
                        - LastButton_19:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              Fill: =Color.Transparent
                              FillPortions: =0
                              Height: =40
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutMinWidth: =0
                              PaddingLeft: =6
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                              - BtnLast_19:
                                  Control: Button@0.0.45
                                  Properties:
                                    Align: =Align.Left
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Appearance: ='ButtonCanvas.Appearance'.Subtle
                                    BasePaletteColor: |-
                                      = RGBA(
                                              65,
                                              105,
                                              225,
                                              1
                                          )
                                    BorderRadius: =0
                                    FillPortions: =1
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Bold
                                    Layout: ='ButtonCanvas.Layout'.TextOnly
                                    LayoutMinWidth: =0
                                    PaddingLeft: =6
                                    Text: =User().FullName
                                    Visible: =If(scrPTOApprovals.Size=1 || scrPTOApprovals.Size=2 ,false,true)
                              - Image1_68:
                                  Control: Image@2.2.3
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledFill: =RGBA(0, 0, 0, 0)
                                    FocusedBorderThickness: =4
                                    Height: =32
                                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                                    HoverFill: =RGBA(0, 0, 0, 0)
                                    Image: =User().Image
                                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                                    PressedFill: =RGBA(0, 0, 0, 0)
                                    RadiusBottomLeft: =32
                                    RadiusBottomRight: =32
                                    RadiusTopLeft: =32
                                    RadiusTopRight: =32
                                    Width: =32
            - MainContainer1_19:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  Fill: =RGBA(255, 245, 237, 1)//ColorFade(Color.AliceBlue,0.5)
                  FillPortions: =0
                  Height: =766
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =18
                  LayoutMinHeight: =0
                  LayoutMinWidth: =0
                  PaddingBottom: =25
                  RadiusBottomLeft: =2
                  RadiusBottomRight: =2
                  RadiusTopLeft: =2
                  RadiusTopRight: =2
                  Width: |-
                    =If(
                        scrPTOApprovals.Size = 1,
                        280,
                        If(
                            scrPTOApprovals.Size = 2,
                            700,
                            If(
                                scrPTOApprovals.Size = 3,
                                800,
                                Parent.Width -SidebarContainer1_19.Width
                            )
                        )
                    )
                  X: =256
                  Y: =2
                Children:
                  - FirstContainer_18:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        Fill: =RGBA(255, 245, 237, 1)//ColorFade(Color.AliceBlue,0.5)
                        FillPortions: =0
                        Height: =60
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        RadiusBottomLeft: =12
                        RadiusBottomRight: =12
                        RadiusTopLeft: =12
                        RadiusTopRight: =12
                        Width: |-
                          =
                          If(
                              scrPTOApprovals.Size = 1,
                              265,
                              If(
                                  scrPTOApprovals.Size = 2,
                                  620,
                                  If(
                                      scrPTOApprovals.Size = 3,
                                      900,
                                      Parent.Width-100
                                  )
                              )
                          )
                      Children:
                        - ContainerTitle_22:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              FillPortions: =0
                              Height: =Parent.Height
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutGap: =550
                              LayoutMinWidth: =0
                              PaddingLeft: =2
                              PaddingRight: =2
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Parent.Width
                            Children:
                              - TextCanvas5_52:
                                  Control: Text@0.0.51
                                  Properties:
                                    Align: ='TextCanvas.Align'.Start
                                    AlignInContainer: =//AlignInContainer.SetByContainer
                                    Font: =Font.'Segoe UI'
                                    Height: =40
                                    LayoutMinWidth: =0
                                    Size: =20
                                    Text: ="Hello " & User().FullName
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Semibold
                                    Width: =400
                              - Arrow1_23:
                                  Control: Arrow@2.3.0
                                  Variant: BackArrow
                                  Properties:
                                    BorderColor: =RGBA(254, 124, 57, 1)
                                    Fill: =RGBA(254, 124, 57, 1)
                                    LayoutMaxHeight: =0
                                    LayoutMaxWidth: =0
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    OnSelect: =Back()
                                    X: =40
                                    Y: =40
                  - MiddleContainer_24:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0
                        Height: =100
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutOverflowX: =LayoutOverflow.Scroll
                        RadiusBottomLeft: =20
                        RadiusBottomRight: =20
                        RadiusTopLeft: =20
                        RadiusTopRight: =20
                        Width: |-
                          =
                          If(
                              scrAllDeliverables.Size = 1,
                              265,
                              If(
                                  scrAllDeliverables.Size = 2,
                                  530,
                                  If(
                                      scrAllDeliverables.Size = 3,
                                      700,
                                      Parent.Width-100
                                  )
                              )
                          )
                      Children:
                        - TextCanvas5_30:
                            Control: Text@0.0.51
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              AlignInContainer: =AlignInContainer.Center
                              Height: =Parent.Height
                              LayoutMinWidth: =0
                              Size: =20
                              Text: ="PTO Approval"
                              VerticalAlign: =VerticalAlign.Middle
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =300
                  - LastContainer_18:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =400
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        RadiusBottomLeft: =20
                        RadiusBottomRight: =20
                        RadiusTopLeft: =20
                        RadiusTopRight: =20
                        Width: |-
                          =
                          If(
                              scrPTOApprovals.Size = 1,
                              265,
                              If(
                                  scrPTOApprovals.Size = 2,
                                  530,
                                  If(
                                      scrPTOApprovals.Size = 3,
                                      700,
                                      Parent.Width-100
                                  )
                              )
                          )
                      Children:
                        - Container6_17:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              FillPortions: =0
                              Height: |-
                                =If(
                                    scrPTOApprovals.Size = 1,
                                    60,
                                    If(
                                        scrPTOApprovals.Size = 2,
                                        60,
                                        If(
                                            scrPTOApprovals.Size = 3,
                                            80,
                                            80
                                        )
                                    )
                                )
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutMinHeight: =0
                              LayoutMinWidth: =0
                              PaddingLeft: =10
                              PaddingTop: =10
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                              - Container8_14:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Start
                                    DropShadow: =DropShadow.None
                                    FillPortions: =0
                                    Height: =Parent.Height
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutMinHeight: =0
                                    PaddingTop: =15
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Width: =800
                                  Children:
                                    - IconSearch_16:
                                        Control: Classic/Icon@2.5.0
                                        Properties:
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          Color: = RGBA(122, 138, 143, 1)
                                          DisabledBorderColor: =RGBA(245, 245, 245, 1)
                                          DisabledColor: =RGBA(225, 223, 221, 1)
                                          DisabledFill: =RGBA(0, 0, 0, 0)
                                          DisplayMode: =DisplayMode.View
                                          Fill: =ColorFade(Color.AliceBlue,0.5)
                                          FocusedBorderThickness: =8
                                          Height: =30
                                          HoverBorderColor: =RGBA(0, 0, 0, 0)
                                          HoverColor: =RGBA(16, 110, 190, 1)
                                          HoverFill: =RGBA(0, 0, 0, 0)
                                          Icon: =Icon.Search
                                          PaddingBottom: =5
                                          PaddingLeft: =5
                                          PaddingRight: =5
                                          PaddingTop: =5
                                          PressedBorderColor: =RGBA(0, 0, 0, 0)
                                          PressedColor: =RGBA(16, 110, 190, 1)
                                          PressedFill: =RGBA(0, 0, 0, 0)
                                          Visible: =false
                                          Width: =30
                                    - DropdownStatus_5:
                                        Control: DropDown@0.0.45
                                        Properties:
                                          Appearance: ='DropdownCanvas.Appearance'.FilledDarker
                                          DefaultSelectedItems: =colStatusDD
                                          Fill: =ColorFade(Color.AliceBlue,0.5)
                                          FontSize: =14
                                          Items: =colStatusDD
                                          Visible: =false
                                          Width: =100
                                    - DropdownWorkstream_5:
                                        Control: DropDown@0.0.45
                                        Properties:
                                          Appearance: ='DropdownCanvas.Appearance'.FilledDarker
                                          DefaultSelectedItems: =colWorkstreamDD
                                          Fill: =ColorFade(Color.AliceBlue,0.5)
                                          FontSize: =14
                                          Items: |+
                                            =colWorkstreamDD
                                          Visible: =false
                                          Width: =100
                                    - Container5_34:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          FillPortions: =0
                                          Height: =Parent.Height
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          LayoutMinHeight: =0
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                          Width: =20
                                    - TextCanvas10_14:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Fill: =ColorFade(Color.AliceBlue,0.5)
                                          FontColor: =RGBA(122, 138, 143, 1)
                                          Height: =40
                                          Size: =0
                                          Text: |-
                                            ="Status : "
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: =
                                          Width: =65
                                          X: =40
                                          Y: =40
                                    - ddStatus_7:
                                        Control: Classic/DropDown@2.3.1
                                        Properties:
                                          BorderColor: =RGBA(214, 221, 224, 1)
                                          ChevronBackground: =RGBA(254, 124, 57, 1)
                                          ChevronFill: =RGBA(255, 255, 255, 1)
                                          ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                          ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                          Default: =
                                          Font: =Font.'Open Sans'
                                          HoverFill: =RGBA(186, 202, 226, 1)
                                          Items: =colStatusDD
                                          Items.Value: =Value
                                          PressedColor: =RGBA(255, 255, 255, 1)
                                          PressedFill: =RGBA(0, 18, 107, 1)
                                          SelectionColor: =RGBA(255, 255, 255, 1)
                                          SelectionFill: =RGBA(56, 96, 178, 1)
                                          Visible: |+
                                            =true
                                          Width: =188
                                          X: =60
                                          Y: =60
                                    - Container5_35:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          FillPortions: =0
                                          Height: =Parent.Height
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          LayoutMinHeight: =0
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                          Width: =20
                                    - TextCanvas10_15:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Fill: =ColorFade(Color.AliceBlue,0.5)
                                          FontColor: =RGBA(122, 138, 143, 1)
                                          Height: =40
                                          Size: =0
                                          Text: |-
                                            ="Workstream : "
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: =
                                          Width: =100
                                          X: =40
                                          Y: =40
                                    - ddWorkstreamFilter_7:
                                        Control: Classic/DropDown@2.3.1
                                        Properties:
                                          BorderColor: =RGBA(214, 221, 224, 1)
                                          ChevronBackground: =RGBA(254, 124, 57, 1)
                                          ChevronFill: =RGBA(255, 255, 255, 1)
                                          ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                          ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                          Default: =
                                          Font: =Font.'Open Sans'
                                          HoverFill: =RGBA(186, 202, 226, 1)
                                          Items: =colWorkstreamDD
                                          Items.Value: =Value
                                          PressedColor: =RGBA(255, 255, 255, 1)
                                          PressedFill: =RGBA(0, 18, 107, 1)
                                          SelectionColor: =RGBA(255, 255, 255, 1)
                                          SelectionFill: =RGBA(56, 96, 178, 1)
                                          Visible: |+
                                            =true
                                          Width: =163
                                          X: =236
                                          Y: =60
                        - ContainerHeaders_1:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              FillPortions: =0
                              Height: =40
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutMinWidth: =0
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Parent.Width
                            Children:
                              - lblHRequester:
                                  Control: Button@0.0.45
                                  Properties:
                                    Align: =Align.Left
                                    Appearance: ='ButtonCanvas.Appearance'.Transparent
                                    FontColor: =RGBA(122, 138, 143, 1)
                                    FontSize: =12
                                    FontWeight: =FontWeight.Normal
                                    Height: =Parent.Height
                                    LayoutMinWidth: =0
                                    Text: ="Requester"
                                    Width: =Parent.Width/6
                              - lblHStartDate:
                                  Control: Button@0.0.45
                                  Properties:
                                    Align: =Align.Left
                                    Appearance: ='ButtonCanvas.Appearance'.Transparent
                                    FontColor: =RGBA(122, 138, 143, 1)
                                    FontSize: =12
                                    FontWeight: =FontWeight.Normal
                                    Height: =Parent.Height
                                    LayoutMinWidth: =0
                                    Text: ="Start Date"
                                    Width: =80
                              - lblHEndDAte:
                                  Control: Button@0.0.45
                                  Properties:
                                    Align: =Align.Left
                                    Appearance: ='ButtonCanvas.Appearance'.Transparent
                                    FontColor: =RGBA(122, 138, 143, 1)
                                    FontSize: =12
                                    FontWeight: =FontWeight.Normal
                                    Height: =Parent.Height
                                    LayoutMinWidth: =0
                                    Text: ="End Date"
                                    Width: |+
                                      =80
                              - lblHHStatus:
                                  Control: Button@0.0.45
                                  Properties:
                                    Align: =Align.Left
                                    Appearance: ='ButtonCanvas.Appearance'.Transparent
                                    FontColor: =RGBA(122, 138, 143, 1)
                                    FontSize: =12
                                    FontWeight: =FontWeight.Normal
                                    Height: =Parent.Height
                                    LayoutMinWidth: =0
                                    Text: ="Status"
                                    Width: =100
                              - lblHApprove:
                                  Control: Button@0.0.45
                                  Properties:
                                    Align: =Align.Left
                                    Appearance: ='ButtonCanvas.Appearance'.Transparent
                                    FontColor: =RGBA(122, 138, 143, 1)
                                    FontSize: =12
                                    FontWeight: =FontWeight.Normal
                                    Height: =Parent.Height
                                    LayoutMinWidth: =0
                                    Text: ="Validate"
                                    Width: =100
                              - lblHReject:
                                  Control: Button@0.0.45
                                  Properties:
                                    Align: =Align.Left
                                    Appearance: ='ButtonCanvas.Appearance'.Transparent
                                    FontColor: =RGBA(122, 138, 143, 1)
                                    FontSize: =12
                                    FontWeight: =FontWeight.Normal
                                    Height: =Parent.Height
                                    LayoutMinWidth: =0
                                    Text: ="Reject"
                                    Width: =100
                        - galPTOApprovals:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =0
                              LayoutMinWidth: =0
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                              - Gallery4_10:
                                  Control: Gallery@2.15.0
                                  Variant: Vertical
                                  Properties:
                                    BorderColor: =RGBA(245, 245, 245, 1)
                                    Height: =Parent.Height
                                    Items: |-
                                      =With(
                                         {
                                             myEmail: User().Email
                                         },
                                         Filter(
                                             TimeOffRequests As t,
                                             t.Status.Value = "Requested" &&
                                             (
                                                 // Admins see everything
                                                 varIsAdmin ||
                                                 // Workstream leaders: my email is one of the Leader emails
                                                 !IsBlank(
                                                     LookUp(
                                                         Workstreams As ws,
                                                         ws.ID = t.Workstream.Id &&
                                                         myEmail in ws.Leader.Email    
                                                     )
                                                 )
                                             )
                                         )
                                      )
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    OnSelect: |-
                                      =Navigate(
                                          scrDeliverablesForm,
                                          ScreenTransition.Fade,
                                          { del: ThisItem }   // pass the full record as a context var
                                      )
                                    TemplatePadding: =
                                    TemplateSize: =80
                                    Transition: =Transition.Push
                                    Width: =Parent.Width
                                    X: =Parent.X
                                  Children:
                                    - Container19_10:
                                        Control: GroupContainer@1.3.0
                                        Variant: ManualLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          Height: =72
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                          Width: =998
                                          X: =Parent.X
                                        Children:
                                          - Button1_50:
                                              Control: Classic/Button@2.2.0
                                              Properties:
                                                BorderColor: =RGBA(0, 0, 0, 0)
                                                BorderStyle: =BorderStyle.None
                                                Color: =RGBA(0, 0, 0, 0)
                                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                                DisabledFill: =RGBA(242, 242, 241, 0)
                                                Fill: =RGBA(0, 0, 0, 0)
                                                Font: =Font.'Segoe UI'
                                                Height: =30
                                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                                HoverColor: =RGBA(0, 0, 0, 0)
                                                HoverFill: =
                                                OnSelect: |-
                                                  =Set(VarCurrentScreen, scrPTOApprovals);

                                                  Navigate(
                                                      scrDeliverablesForm,
                                                      ScreenTransition.Fade,
                                                      { del: ThisItem }   // pass the full record as a context var
                                                  )
                                                PressedBorderColor: =
                                                PressedColor: =Color.Transparent
                                                PressedFill: =
                                                Width: =408
                                          - lblStatus11_16:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Start
                                                Height: =Parent.Height
                                                PaddingLeft: =15
                                                Size: =12
                                                Text: =ThisItem.ApprovedBy.DisplayName
                                                VerticalAlign: =VerticalAlign.Middle
                                                Weight: ='TextCanvas.Weight'.Semibold
                                                Width: =103
                                                X: =lblHHStatus.X
                                          - lblStatus11_15:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Start
                                                Height: =Parent.Height
                                                PaddingLeft: =15
                                                Size: =12
                                                Text: =ThisItem.Status.Value
                                                VerticalAlign: =VerticalAlign.Middle
                                                Weight: ='TextCanvas.Weight'.Semibold
                                                Width: =103
                                                X: =lblHHStatus.X
                                          - Rectangle1_33:
                                              Control: Rectangle@2.3.0
                                              Properties:
                                                BorderColor: =RGBA(0, 0, 0, 0)
                                                BorderStyle: =BorderStyle.None
                                                BorderThickness: =1
                                                DisabledFill: =RGBA(161, 159, 157, 1)
                                                Fill: =ColorFade(Color.Gray,0.5)
                                                FocusedBorderThickness: =4
                                                Height: =0
                                                HoverFill: =RGBA(0, 120, 212, 1)
                                                PressedFill: =RGBA(0, 120, 212, 1)
                                                Width: =Parent.Width
                                                Y: =66
                                          - btnApprove:
                                              Control: Classic/Button@2.2.0
                                              Properties:
                                                BorderColor: =Color.Green
                                                Color: =RGBA(52, 152, 47, 1)
                                                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                                Fill: =RGBA(255, 255, 255, 1)
                                                Font: =Font.'Open Sans'
                                                Height: =36
                                                HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                                HoverColor: =RGBA(255, 255, 255, 1)
                                                HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                                OnSelect: |-
                                                  =UpdateContext(
                                                     {
                                                         locPTORecord: ThisItem,
                                                         locDecision: "Approve",
                                                         locShowDecisionDialog: true
                                                     }
                                                  );
                                                  Reset(txtDecisionComment);
                                                PressedBorderColor: =Self.Fill
                                                PressedColor: =Self.Fill
                                                PressedFill: =Self.Color
                                                Text: =UniChar(10004)
                                                Width: =lblHApprove.Width
                                                X: =lblHApprove.X
                                                Y: =18
                                          - btnReject:
                                              Control: Classic/Button@2.2.0
                                              Properties:
                                                BorderColor: =Color.Red
                                                Color: =RGBA(255, 255, 255, 1)
                                                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                                Fill: =RGBA(255, 255, 255, 1)
                                                Font: =Font.'Open Sans'
                                                Height: =36
                                                HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                                HoverColor: =RGBA(255, 255, 255, 1)
                                                HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                                OnSelect: |-
                                                  =UpdateContext(
                                                     {
                                                         locPTORecord: ThisItem,
                                                         locDecision: "Reject",
                                                         locShowDecisionDialog: true
                                                     }
                                                  );
                                                  Reset(txtDecisionComment);
                                                PressedBorderColor: =Self.Fill
                                                PressedColor: =Self.Fill
                                                PressedFill: =Self.Color
                                                Text: |-
                                                  =UniChar(10060
                                                  )
                                                Width: =lblHReject.Width
                                                X: =lblHReject.X
                                                Y: =18
                                          - lblRequester:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Start
                                                Height: =Parent.Height
                                                PaddingLeft: =15
                                                Size: =12
                                                Text: =ThisItem.Requester.DisplayName
                                                VerticalAlign: =VerticalAlign.Middle
                                                Weight: ='TextCanvas.Weight'.Semibold
                                                Width: =lblHRequester.Width
                                          - lblStartDate:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Start
                                                Height: =Parent.Height
                                                PaddingLeft: =15
                                                Size: =12
                                                Text: =ThisItem.StartDate
                                                VerticalAlign: =VerticalAlign.Middle
                                                Weight: ='TextCanvas.Weight'.Semibold
                                                Width: =103
                                                X: =lblHStartDate.X
                                          - lblStatus11_17:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Start
                                                Height: =Parent.Height
                                                PaddingLeft: =15
                                                Size: =12
                                                Text: =ThisItem.EndDate
                                                VerticalAlign: =VerticalAlign.Middle
                                                Weight: ='TextCanvas.Weight'.Semibold
                                                Width: =103
                                                X: =lblHEndDAte.X
      - cntDecisionDialog:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(0,0,0,0.25)
            Height: =260
            LayoutDirection: =LayoutDirection.Vertical
            LayoutOverflowX: =LayoutOverflow.Scroll
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Visible: =locShowDecisionDialog
            X: =(Parent.Width - Self.Width) / 2
            Y: =(Parent.Height - Self.Height) / 2
          Children:
            - cntDialogCard:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Color.White
                  Height: =260
                  LayoutMaxHeight: =0
                  LayoutMaxWidth: =0
                  LayoutMinHeight: =16
                  LayoutMinWidth: =16
                  PaddingBottom: =20
                  PaddingLeft: =20
                  PaddingRight: =20
                  PaddingTop: =20
                  RadiusBottomLeft: =12
                  RadiusBottomRight: =12
                  RadiusTopLeft: =12
                  RadiusTopRight: =12
                  X: =(Parent.Width - Self.Width) / 2
                  Y: =(Parent.Height - Self.Height) / 2
                Children:
                  - btnDialogConfirm:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =RGBA(255, 255, 255, 1)
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(254, 124, 57, 1)
                        Font: =Font.'Open Sans'
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                             // 1) Require a comment when rejecting
                             locDecision = "Reject" && IsBlank(Trim(txtDecisionComment.Value)),
                             Notify(
                                 "Please add a comment when rejecting a request.",
                                 NotificationType.Error
                             ),
                             // 2) Otherwise, save the decision
                             Patch(
                                 TimeOffRequests,
                                 locPTORecord,
                                 {
                                     Status: {
                                         Value: If(
                                             locDecision = "Approve",
                                             "Approved",
                                             "Rejected"
                                         )
                                     },
                                     ApprovedOn: Now(),
                                     ApprovedBy: {
                                         '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                                         Claims: "i:0#.f|membership|" & Lower(User().Email),
                                         DisplayName: User().FullName,
                                         Email: User().Email,
                                         Department: "",
                                         JobTitle: "",
                                         Picture: ""
                                     },
                                     Comments:
                                         If(
                                             IsBlank(Trim(txtDecisionComment.Value)),
                                             locPTORecord.Comments,
                                             txtDecisionComment.Value
                                         )
                                 }
                             );
                             // 3) Tell the user what happened
                             Notify(
                                 "PTO request " &
                                 If(locDecision = "Approve", "approved.", "rejected."),
                                 NotificationType.Success
                             );
                             // 4) Close dialog + reset
                             UpdateContext(
                                 {
                                     locShowDecisionDialog: false,
                                     locDecision: "",
                                     locPTORecord: Blank()
                                 }
                             );
                             Reset(txtDecisionComment)
                          );
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Size: =10
                        Text: ="Confirm"
                        Width: =120
                        X: =Parent.Width - Self.Width - 10
                        Y: =Parent.Height - Self.Height - 10
                  - btnDialogCancel:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =RGBA(255, 255, 255, 1)
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(254, 124, 57, 1)
                        Font: =Font.'Open Sans'
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext(
                             {
                                 locShowDecisionDialog: false,
                                 locDecision: "",
                                 locPTORecord: Blank()
                             }
                          );
                          Reset(txtDecisionComment);
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Size: =10
                        Text: ="Cancel"
                        Width: =120
                        X: =btnDialogConfirm.X - Self.Width - 10
                        Y: =btnDialogConfirm.Y
                  - txtDecisionComment:
                      Control: TextInput@0.0.54
                      Properties:
                        Height: =120
                        Mode: ='TextInputCanvas.Mode'.Multiline
                        Placeholder: ="Add your comment (required for rejection)"
                        Width: =Parent.Width
                        Y: =lblDialogTitle.Y + lblDialogTitle.Height + 10
                  - lblDialogTitle:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        Height: =40
                        Size: =20
                        Text: =If(locDecision = "Approve", "Approve PTO request", "Reject PTO request")
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =Parent.Width
